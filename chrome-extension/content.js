(()=>{"use strict";(new class{constructor(){this.lastUpdate=0,this.updateInterval=5e3,this.latestData=null,this.observer=new MutationObserver(this.handleDOMChanges.bind(this))}start(){this.extractInitialData(),this.observer.observe(document.body,{childList:!0,subtree:!0}),chrome.runtime.onMessage.addListener(((t,e,a)=>{if("GET_MARKET_DATA"===t.type)return console.log("Received request for market data"),console.log("Current data:",this.latestData),a(this.latestData),!0}))}handleDOMChanges(t){const e=Date.now();e-this.lastUpdate>=this.updateInterval&&(this.extractInitialData(),this.lastUpdate=e)}extractInitialData(){const t=this.extractMarketData();t&&(this.latestData=t,chrome.runtime.sendMessage({type:"MARKET_DATA_UPDATE",data:t}))}extractMarketData(){try{return window.location.hostname.includes("tradingview.com")?this.extractTradingViewData():window.location.hostname.includes("yahoo.com")?this.extractYahooFinanceData():null}catch(t){return console.error("Error extracting market data:",t),null}}extractTradingViewData(){const t=document.querySelector('[data-name="last"]'),e=document.querySelector('[data-name="volume"]'),a=document.querySelector(".chart-container [data-symbol]");return t&&e&&a?{symbol:a.getAttribute("data-symbol")||"",price:parseFloat(t.textContent||"0"),volume:parseFloat(e.textContent||"0"),timestamp:Date.now()}:null}extractYahooFinanceData(){const t=document.querySelector('[data-test="qsp-price"]'),e=document.querySelector('[data-test="qsp-volume"]'),a=document.querySelector('[data-test="qsp-symbol"]');return t&&e&&a?{symbol:a.textContent||"",price:parseFloat(t.textContent||"0"),volume:parseFloat(e.textContent||"0"),timestamp:Date.now()}:null}}).start()})();